!function(n){var r={};function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="../",o(o.s=0)}([function(t,e,n){n(2),t.exports=n(1)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r=void 0,s=new Vue({el:"#app",data:{data:{country:"",debt:"",population:"",total:[],showCountryInfo:!1,init:!0,map:null,currGeoLocation:[],overviewIsClicked:!1,loaded:!0,countryItems:[],currentDebtPerCitizen:0,pastDebtPerCitizen:0,selectedCountryProducts:[],barchartIsDrawn:!1}},methods:{closeCountryInfo:function(){r.showCountryInfo=!1,document.querySelector(".map-section").style="width: 30vw; transform: translateX(0)",r.map&&r.map.flyTo({pitch:0,zoom:4})},formatNumbersByDots:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},setCenter:function(){r.map&&r.map.flyTo({pitch:0,center:[10.214134,47.440152],zoom:4})},setOverviewClickedStatus:function(){r.overviewIsClicked=!r.overviewIsClicked}}});function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}d3.json("../data/countryItems.json").then(function(t){return s.countryItems=t}).catch(function(t){return t});var u=Promise.all(["../data/worldGeoCodes.csv","../data/europeDebt.csv","../data/totalPopulation.csv"].map(function(t){return d3.csv(t)})).then(function(t){var e,n=d3.nest().key(function(t){return t.name}).rollup(function(t){return t.map(function(t){return{long:t.longitude,lat:t.latitude}})}).entries(t[0]),r=d3.nest().key(function(t){return t.TIME}).entries(t[1]).filter(function(t){return 2015<t.key}).map(function(t){return t.values.map(function(t){return function(o){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},e=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.forEach(function(t){var e,n,r;e=o,r=a[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r})}return o}({key:t.GEO,debt:t.Value},t)})}),o=d3.nest().key(function(t){return t["Country Name"]}).rollup(function(t){return t[0][2016]}).entries(t[2]);return(e=[]).concat.apply(e,a(r).concat(a(o),a(n),a(s.countryItems)))}).then(function(t){var e=d3.nest().key(function(t){return t.key}).entries(t).filter(function(t){return 2<t.key.length}).filter(function(t){return 2<t.values.length}).map(function(t){return{country:t.key,debt:t.values.filter(function(t){return"Million euro"==t.UNIT}).map(function(t){return 1e6*t.debt.replace(",","").replace(".","")}),population:t.values.filter(function(t){return 500<t.value?t.value:""}),food:t.values.map(function(t){return"object"==o(t.food)?t.food:""}).filter(function(t){return t||""})[0],lat:t.values.map(function(t){return"object"==o(t.value)?t.value[0].lat:""}).filter(function(t){return t||""})[0],long:t.values.map(function(t){return"object"==o(t.value)?t.value[0].long:""}).filter(function(t){return t||""})[0]}});return s.total=e}).catch(function(t){return t});function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"map",function(){return l}),n.d(e,"generateListWithCountries",function(){return m}),n.d(e,"generateInformationTips",function(){return y}),n.d(e,"generateChartWithCountryInfo",function(){return v}),mapboxgl.accessToken="pk.eyJ1Ijoibm9jbHVlNHUiLCJhIjoiY2pvZWY2ZTA5MXdkbjN3bGVicm1hZDNvZCJ9.kIU-GIm7Cl36xhEFLaPU1w";var l=new mapboxgl.Map({container:"map",style:"mapbox://styles/noclue4u/cjoeoyn8u0htn2sobi8b7qy5k",center:[10.214134,47.440152],maxZoom:10,minZoom:3,zoom:3,doubleClickZoom:!1}),c=l.getCanvasContainer(),f=l.getZoom(),p=d3.select(c).append("svg").append("g");function y(t,e){p.selectAll("circle").data(t).enter().append("circle").on("click",function(t){return b(t)}).transition().duration(0).attr("cx",function(t){return h([+t.long,+t.lat]).x}).attr("cy",function(t){return h([+t.long,+t.lat]).y});var n=function(){p.selectAll("circle").attr("cx",function(t){return h([+t.long,+t.lat]).x}).attr("cy",function(t){return h([+t.long,+t.lat]).y}).transition().duration(750).attr("r",function(t){return"totalDebt"==e?Math.sqrt(+t.debt[1]/1e11*100)+3:"totalPopulation"==e?t.population.length?Math.sqrt(+t.population[0].value/1e7*100)+3:0:"totalDebtPerCitizen"==e?t.population.length?Math.sqrt(+t.debt[1]/1e11/(+t.population[0].value/1e7)*100)+3:0:Math.sqrt(+t.debt[1]/1e11*100)+3})};n(),l.on("viewreset",function(){return n()}).on("move",function(){return n()}).on("moveend",function(){return n()}).on("zoom",function(){return n()})}function m(t,n){d3.select(t).append("select").attr("class","countrySelection").on("change",function(t){var e=d3.select(".countrySelection").property("value");return n.filter(function(t){return t.country==e}).map(function(t){return b(t)})}).selectAll("option").data(n.map(function(t){return t.country})).enter().append("option").text(function(t){return t})}function b(t){var e,n,r,o,a,u,i,c;n=(e=t).debt[0]?e.debt[0]:0,r=e.debt[1]?e.debt[1]:e.debt,o=e.population[0].value?e.population[0].value:"",a=(r/o).toFixed(2),u=(n/o).toFixed(2),s.currentDebtPerCitizen=a,s.pastDebtPerCitizen=u,i="increase",document.querySelector(".map-section").style="increase"==i?"width: 45vw; transform: translateX(0)":"width: 30vw; transform: translateX(0)",c=t,s.showCountryInfo=!0,s.country=c.country,s.debt=c.debt,s.population=c.population[0].value,s.currGeoLocation={lat:c.lat,long:c.long},s.selectedCountryProducts=c.food,s.showCountryInfo&&v(t),l.flyTo({center:[s.currGeoLocation.long,s.currGeoLocation.lat],zoom:2*f,offset:[-300,0],pitch:30,curve:2,speed:.5})}function v(t){var r=[],o=[];t.food.map(function(t){var e=d({debt:Number((s.currentDebtPerCitizen/t.price).toFixed(0))},t),n=d({debt:Number((s.pastDebtPerCitizen/t.price).toFixed(0))},t);r.push(d({key:2017},e)),o.push(d({key:2016},n))});var e=[].concat(o,r);e&&function(t){console.log(t);var e={top:60,right:20,bottom:30,left:40},n=450-e.left-e.right,o=400-e.top-e.bottom,a=d3.select(".countryDebtChart");if(!s.barchartIsDrawn)a.append("g").attr("class","layer").attr("transform","translate("+e.left+","+e.top+")");var u=a.select(".layer"),i=d3.scaleBand().rangeRound([0,n]).paddingInner(.1),c=d3.scaleBand().padding(.05),l=d3.scaleLinear().rangeRound([o,0]),f=d3.scaleOrdinal().range(["#F7E3AF","#F7AF9D","#C08497"]);i.domain(t.map(function(t){return t.key})),c.domain(t.map(function(t){return t.name})).rangeRound([0,i.bandwidth()]),l.domain([0,d3.max(t,function(t){return t.debt})]).nice();var r=d3.nest().key(function(t){return t.key}).entries(t);u.append("g").selectAll("g").data(r).enter().append("g").attr("class","bar").attr("transform",function(t){return"translate("+i(t.key)+",0)"}).selectAll("rect").data(function(t){return t.values.map(function(t){return d({key:t.key},t)})}).enter().append("rect").attr("x",function(t){return c(t.name)}).attr("y",function(t){return l(t.debt)}).attr("width",c.bandwidth()).attr("height",function(t){return o-l(t.debt)}).attr("fill",function(t){return f(t.name)}).on("mouseover",function(t){d3.select("#tooltip").style("right","2vw").style("top","48vh").select("#value").text("\n\t\t\t\t\tevery citizin should buy / sell ".concat(t.debt," ").concat(t.name," to pay off the debt.\n\t\t\t\t\tThe price of a ").concat(t.name," is â‚¬").concat(t.price)),d3.select("#tooltip").classed("hidden",!1)}).on("mouseout",function(){return d3.select("#tooltip").classed("hidden",!0)}),s.barchartIsDrawn||(u.append("g").attr("class","xAxis").attr("transform","translate(0,"+o+")").call(d3.axisBottom(i)).append("text").attr("fill","#fff").attr("font-weight","bold").attr("text-anchor","start").attr("transform","translate(".concat(n,",0)")).text("Years"),u.append("g").attr("class","yAxis").call(d3.axisLeft(l).ticks(null,"s")).append("text").attr("x",2).attr("y",l(l.ticks().pop())+.5).attr("dy","0.32em").attr("fill","#fff").attr("font-weight","bold").attr("text-anchor","start").text("Amount"));u.select(".xAxis").attr("transform","translate(0,"+o+")").call(d3.axisBottom(i)).append("text").attr("fill","#fff").attr("font-weight","bold").attr("text-anchor","start").attr("transform","translate(".concat(n,",0)")).text("Years"),u.select(".yAxis").call(d3.axisLeft(l).ticks(null,"s")).append("text").attr("x",2).attr("y",l(l.ticks().pop())+.5).attr("dy","0.32em").attr("fill","#fff").attr("font-weight","bold").attr("text-anchor","start").text("Amount"),s.barchartIsDrawn=!0,function(t){var e=d3.nest().key(function(t){return t.key}).entries(t);c.domain(t.map(function(t){return t.name})).rangeRound([0,i.bandwidth()]),l.domain([0,d3.max(t,function(t){return t.debt})]).nice(),a.select(".yAxis").transition().call(d3.axisLeft(l).ticks(null,"s")).duration(500);var n=u.selectAll("g.bar").data(e);n.enter().append("g").classed("bar",!0).attr("transform",function(t){return"translate("+i(t.key)+",0)"}),n.exit().remove();var r=u.selectAll("g.bar").selectAll("rect").data(function(t){return t.values.map(function(t){return d({key:t.key},t)})});r.enter().append("rect").attr("x",function(t){return c(t.name)}).attr("y",function(t){return l(t.debt)}).attr("width",c.bandwidth()).attr("height",function(t){return o-l(t.debt)}).attr("fill",function(t){return f(t.name)}),r.transition().duration(750).attr("y",function(t){return l(t.debt)}).attr("height",function(t){return o-l(t.debt)})}(t)}(e)}function h(t){return l.project(new mapboxgl.LngLat(+t[0],+t[1]))}l.on("load",function(){s.map=l,s.loaded=!0,u.then(function(t){var e;e=t,mapDataFilter.addEventListener("change",function(t){y(e.map(function(t){return t}),t.target.value)}),y(t.map(function(t){return t})),m("#countries",t.map(function(t){return t}))}).catch(function(t){return console.error(t)})})}]);